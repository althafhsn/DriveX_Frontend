<div class="container">
  <h5 class="text-center mb-4">Add New Car</h5>
  <form (ngSubmit)="onSubmit()" #carForm="ngForm" class="needs-validation">
    <!-- Brand Dropdown -->
    <div class="mb-3">
      <label for="brand">Select Brand:</label>
      <select
        id="brand"
        class="form-select"
        [(ngModel)]="newCar.brandId"
        (change)="onBrandChange($event)"
        name="brand"
        required
      >
        <option value="" disabled>Select a Brand</option>
        <option *ngFor="let brand of brands" [value]="brand.id">{{ brand.name }}</option>
      </select>
      <button type="button" class="btn btn-outline-primary" (click)="toggleAddBrand()">+</button>
    </div>

    <div *ngIf="showAddBrand" class="mt-2">
      <input
        type="text"
        class="form-control"
        placeholder="Enter new brand"
        [(ngModel)]="newBrandName"
        name="newBrandName"
      />
      <button type="button" class="btn btn-success mt-2" (click)="addBrand()">Add Brand</button>
    </div>

    <!-- Model Dropdown -->
    <div class="mb-3">
      <label for="model">Select Model:</label>
      <select
        id="model"
        class="form-select"
        [(ngModel)]="newCar.modelId"
        name="model"
        required
        [disabled]="!models.length"
      >
        <option value="" disabled *ngIf="!models.length">No Models Available</option>
        <option *ngFor="let model of models" [value]="model.id">{{ model.name }}</option>
      </select>
      <button type="button" class="btn btn-outline-primary" (click)="toggleAddModel()">+</button>
    </div>

    <!-- Add Model Input -->
    <div *ngIf="showAddModel" class="mt-2">
      <input
        type="text"
        class="form-control"
        placeholder="Enter new model"
        [(ngModel)]="newModelName"
        name="newModelName"
      />
      <div class="mt-2">
        <button type="button" class="btn btn-success" (click)="addModel()">Add Model</button>
        <button type="button" class="btn btn-secondary ms-2" (click)="toggleAddModel()">Cancel</button>
      </div>
    </div>

    <!-- Registration Number -->
    <div class="mb-3">
      <label for="regNo">Registration Number:</label>
      <input
        type="text"
        id="regNo"
        class="form-control"
        placeholder="Enter Registration Number"
        [(ngModel)]="newCar.regNo"
        name="regNo"
        required
      />
    </div>

    <!-- Price Per Day -->
    <div class="mb-3">
      <label for="pricePerDay">Price Per Day:</label>
      <input
        type="number"
        id="pricePerDay"
        class="form-control"
        placeholder="Enter Price Per Day"
        [(ngModel)]="newCar.pricePerDay"
        name="pricePerDay"
        required
      />
    </div>

    <!-- Gear Type -->
    <div class="mb-3">
      <label for="gearType">Gear Type:</label>
      <select
        id="gearType"
        class="form-select"
        [(ngModel)]="newCar.gearType"
        name="gearType"
        required
      >
        <option value="" disabled>Select Gear Type</option>
        <option value="Automatic">Automatic</option>
        <option value="Manual">Manual</option>
      </select>
    </div>

    <!-- Fuel Type -->
    <div class="mb-3">
      <label for="fuelType">Fuel Type:</label>
      <select
        id="fuelType"
        class="form-select"
        [(ngModel)]="newCar.fuelType"
        name="fuelType"
        required
      >
        <option value="" disabled>Select Fuel Type</option>
        <option value="Petrol">Petrol</option>
        <option value="Diesel">Diesel</option>
      </select>
    </div>

    <!-- Mileage -->
    <div class="mb-3">
      <label for="mileage">Mileage (km):</label>
      <input
        type="text"
        id="mileage"
        class="form-control"
        placeholder="Enter Mileage"
        [(ngModel)]="newCar.mileage"
        name="mileage"
        required
      />
    </div>

    <!-- Seat Count -->
    <div class="mb-3">
      <label for="seatCount">Seat Count:</label>
      <input
        type="number"
        id="seatCount"
        class="form-control"
        placeholder="Enter Seat Count"
        [(ngModel)]="newCar.seatCount"
        name="seatCount"
        required
      />
    </div>

    <!-- Multiple Images Upload -->
    <div class="mb-3">
      <label for="images">Upload Images (Max: 4):</label>
      <input
        type="file"
        id="images"
        class="form-control"
        (change)="onFileSelect($event)"
        multiple
        accept="image/*"
      />
      <div class="mt-2">
        <div *ngFor="let image of selectedImages; let i = index" class="mb-2">
          <img [src]="image" alt="Car Image" class="img-thumbnail" style="width: 150px; height: 100px;" />
          <button
            type="button"
            class="btn btn-sm btn-danger ms-2"
            (click)="removeImage(i)"
          >
            Remove
          </button>
        </div>
      </div>
    </div>

    <!-- Submit Button -->
    <button
      type="submit"
      class="btn btn-primary w-100"
      [disabled]="!carForm.form.valid"
    >
      Add Car
    </button>
  </form>
</div>
